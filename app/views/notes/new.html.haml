- content_for(:header) do
  =stylesheet_link_tag "wikis"
  = javascript_include_file 'wiki-wizard'

:javascript
  $(document).ready(function(){
    jQuery("#wiki_action").wizard();
  });

#wiki_action
  - form_for(@note, :url=>notes_path) do |f|
    .errors= sanitize f.error_messages

    - render_wizard(0, :select_group) do
      .wizard_content
        .topic
          新しくWikiを作成しましょう！！！
          <br/>
          まずはWikiを作成する対象を選択してください。

        %table.skipwiki
          %tr
            %td
              =f.radio_button(:group_backend_type, "BuiltinGroup")
              =f.label :group_backend_type, h(_"個人用Wiki"), :for=>"note_group_backend_type_builtingroup"
            %td &nbsp;
          %tr
            %td
              =f.radio_button(:group_backend_type, "SkipGroup")
              =f.label :group_backend_type, h(_"SKIPグループ"), :for=>"note_group_backend_type_skipgroup"
            %td
              =f.select :group_backend_id, current_user.memberships.select{|m| m.group.backend_type == "SkipGroup" }.map{|m| [m.group.display_name, m.group.backend_id] }

    -render_wizard(1, :select_publicity) do
      .wizard_content
        .topic
          次のステップではWikiの公開範囲を設定します。<br/>

        %table.skipwiki
          - [Note::PUBLICITY_MEMBER_ONLY, Note::PUBLICITY_READABLE, Note::PUBLICITY_WRITABLE].each do |pub|
            %tr
              %td
                =f.radio_button(:publicity, pub)
                =f.label "publicity_#{pub}", h(publicity_label(pub))
              %td &nbsp;

        .example
          %ul
            %li
              =h _"グループメンバーのみ閲覧/書込できる"
              %ul.sub
                %li&= "そのWikiにアクセス可能なグループのメンバーのみが読み書きできます。"
                %li&= "プロジェクト内や特定のユーザのみで利用するWikiにしたい場合に選びます。"
            %li
              =h _"全員が閲覧できる"
              %ul.sub
                %li
                  グループメンバーが読み書きできるのに加え、<strong>グループに所属していないユーザ</strong>
                  もWikiの内容を閲覧することができます。
                %li&= _"そのグループからグループ外に情報を発信したい場合に選びます。"
            %li
              =h _"全員が閲覧/書込できる"
              %ul.sub
                %li
                  グループに所属していないユーザを含む、<strong>あらゆるユーザ</strong>
                  が編集できるWikiになります。
                %li&= _"Wikipediaのようにみんなでコンテンツを作っていくWikiにしたい場合に選びます。"

    -render_wizard(2, :select_label_navigation_style) do
      .wizard_content
        .topic
          次のステップではページ表示時のラベルナビゲーションの表示方法を設定します。<br/>

        %table.skipwiki
          - LabelIndex.navigation_styles.each do |style|
            %tr
              %td
                =f.radio_button(:label_navigation_style, style)
                =f.label "label_navigation_style_#{style}", h(navi_style_label(style))
              %td &nbsp;

        .example
          %ul
            %li
              =h navi_style_label(LabelIndex::NAVIGATION_STYLE_NONE)
              %ul.sub
                %li&= "ラベルツールバーを表示しません。"
                %li&= "公式発表など、他のページへのナビゲーションが不要な場合に選びます。"
            %li
              =h navi_style_label(LabelIndex::NAVIGATION_STYLE_TOGGLE)
              %ul.sub
                %li&= "ラベルツールバーの表示を切り替えられます。"
                %li&= "ナビゲーションバーを用意したいが、全画面表示も使いたい場合に選びます。"
                %li
                  ページの初期表示時には、<strong>ツールバーが表示</strong>されています。"
            %li
              =h navi_style_label(LabelIndex::NAVIGATION_STYLE_ALWAYS)
              %ul.sub
                %li&= "ラベルツールバーを常に表示します。"
                %li&= "グループ内のWikiなど、ナビゲーションが簡単に出きるようにしたい場合に選びます"

    -render_wizard(3, :select_input_name) do
      .wizard_content
        .topic
          次のステップでは
          %strong= _("Note|Display name")
          と
          %strong= _("Note|Name")
          を入力してください。

        %table.skipwiki
          %tr
            %td= f.label :display_name, _("Note|Display name")
            %td= f.text_field :display_name
          %tr
            %td= f.label :name, _("Note|Name")
            %td= f.text_field :name

        .example
          .h4 名称の例
          最近作成されたWikiの名称です。
          %ul
            - current_user.free_or_accessible_notes.recent.each do |note|
              %li= note.display_name

        .example
          .h4 識別名の例
          // FIXME
          例えば、グループのWikiで識別名を<b><u>sonic_note</u></b>と入力すると、次のURLでアクセスできます。
          %div{:style=>"margin:5px 0 0 10px;color:green"}
            = note_url("sonic_note")

    -render_wizard(4, :select_list_attachments) do
      .wizard_content
        .topic
          次のステップでは
          %strong= _("Note|List attachments")
          を入力してください。

        %table.skipwiki
          - [false, true].each do |val|
            %tr
              %td
                =f.radio_button(:list_attachments, val)
                =f.label "list_attachments_#{val}", h(list_attachments_label(val))

        .example
          %h4 説明
          Wikiを呼んでいる一般ユーザに、添付ファイル一覧を表示するかどうかを設定します。
          %ul
            %li
              =h _("NOT list attachment for download.")
              %ul.sub
                %li&= "そのWikiの編集権限のないユーザは、添付ファイルの一覧にアクセスできません。"
                %li&= "ページに埋め込まれたリンクからはダウンロードできます。"
            %li
              =h _("List attachment for download.")
              %ul.sub
                %li&= "そのWikiの編集権限のないユーザも、添付ファイルの一覧にアクセスできます。"
                %li&= "情報共有用のWikiなど、全員で添付ファイルを共有する場合に選びます。"

    - render_wizard(5, :confirm) do
      .wizard_content
        .topic
          この内容でよろしいですか?
          =f.submit _("Create")

        %table.confirmation.input.skipwiki
          %tr.group_backend_type
            %th&= _("Note|GroupBackendType")
            %td&= ""
          %tr.category_id
            %th&= _("Note|Category")
            %td&= ""
          %tr.publicity
            %th&= _("Note|Publicity")
            %td&= ""
          %tr.label_navigation_style
            %th&= _("Note|LabelNavigationStyle")
            %td&= ""
          %tr.display_name
            %th&= _("Note|Display name")
            %td&= ""
          %tr.name
            %th&= _("Note|Name")
            %td&= ""
          %tr.list_attachments
            %th&= _("Note|List attachments")
            %td&= ""

= link_to 'Back', notes_path

